only solved A and B because I struggled for an hour with precision issues on C :((

Lost 140 rating points XD